<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Real Apk â€” Apps</title>
  <script>/* Minimal inline tailwind fallback: we'll use simple CSS so page works even when CDNs blocked */</script>
  <style>
    :root{--bg:#0f1724;--card:#151d2a;--muted:#9aa4b2;--accent:#4f8df7}
    html,body,#root{height:100%}
    body{margin:0;font-family:Inter,system-ui,Arial;background:var(--bg);color:#eaf3ff}
    .container{max-width:980px;margin:0 auto;padding:16px}
    header{display:flex;align-items:center;justify-content:space-between}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .dot{width:44px;height:44px;border-radius:999px;background:#7c3aed}
    .search{background:var(--card);padding:8px 12px;border-radius:999px;display:flex;gap:8px;align-items:center;min-width:200px}
    .featured-row{display:flex;gap:14px;overflow-x:auto;padding-bottom:8px;margin-top:12px}
    .card{background:var(--card);border-radius:16px;padding:14px;min-width:320px;box-shadow:0 10px 25px rgba(0,0,0,0.6)}
    .small-card{display:flex;gap:12px;align-items:center}
    .pill{background:#24303c;padding:6px 10px;border-radius:999px;color:var(--muted);font-weight:600}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-top:12px}
    img.logo-img{width:84px;height:84px;border-radius:12px;object-fit:cover}
    button.primary{background:linear-gradient(180deg,var(--accent),#2166d6);color:white;padding:8px 12px;border-radius:10px;border:none;font-weight:700}
    .detail-hero{padding:28px;border-radius:16px;background:linear-gradient(180deg,#071029,#0b1220);box-shadow:0 10px 35px rgba(0,0,0,0.6)}
    .screens{display:flex;gap:12px;overflow-x:auto;padding:8px 0;margin-top:12px}
    .screens img{min-width:180px;height:320px;border-radius:12px;object-fit:cover}
    .loader-ring{width:72px;height:72px;border-radius:999px;border:8px solid rgba(255,255,255,0.06);border-top-color:var(--accent);animation:spin 1s linear infinite;margin:18px auto}
    @keyframes spin{to{transform:rotate(360deg)}}
    .admin-form input,.admin-form textarea{width:100%;padding:8px;margin-top:8px;border-radius:8px;background:#0f1a28;color:#eaf3ff;border:1px solid rgba(255,255,255,0.03)}
    .admin-actions{display:flex;gap:8px;margin-top:8px}
    a { color: inherit; text-decoration:none; }
    .muted{color:var(--muted)}
    /* small scrollbar hide */
    .featured-row::-webkit-scrollbar, .screens::-webkit-scrollbar { display:none }
    @media(max-width:520px){ .card{min-width:280px} .screens img{min-width:150px;height:260px} }
  </style>
</head>
<body>
  <div id="root" class="container"></div>

  <!-- Firebase (compat for simplicity) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <script>
  /***** CONFIG: replace if you want; currently uses your provided config *****/
  const FIREBASE_CONFIG = {
    apiKey: "AIzaSyDAoDGn6lymDsAia_SNue37MiyfD80pFKU",
    authDomain: "website-builder-e975c.firebaseapp.com",
    projectId: "website-builder-e975c",
    storageBucket: "website-builder-e975c.firebasestorage.app",
    messagingSenderId: "200054863866",
    appId: "1:200054863866:web:fe88010678557c7f9f9643",
    measurementId: "G-84KLJLYTPZ"
  };
  firebase.initializeApp(FIREBASE_CONFIG);
  const db = firebase.firestore();

  /***** Simple hash routing helpers *****/
  function getHash(){ const h=location.hash||''; if(h.startsWith('#post:')) return {m:'post',id:h.slice(6)}; if(h.startsWith('#dl:')) return {m:'dl',id:h.slice(4)}; if(h==='#adminsecret') return {m:'admin'}; return {m:'home'}; }
  function openPostNewTab(id){ window.open(location.origin + location.pathname + '#post:' + id, '_blank'); }
  function openDownloadLoader(id){ window.open(location.origin + location.pathname + '#dl:' + id, '_blank'); }

  /***** Render helpers (vanilla JS) *****/
  const root = document.getElementById('root');

  function el(tag,attrs,children){ const e=document.createElement(tag); if(attrs) Object.entries(attrs).forEach(([k,v])=>{ if(k==='html') e.innerHTML=v; else if(k==='on') e.addEventListener(v.ev,v.fn); else e.setAttribute(k,v); }); if(children) children.forEach(c=> e.appendChild(typeof c==='string'?document.createTextNode(c):c)); return e; }

  /***** App render functions *****/
  async function renderHome(){
    root.innerHTML='';
    const header = el('header',{},[
      el('div',{class:'logo'},[ el('div',{class:'dot'}), el('div',{style:'font-weight:800;font-size:18px'},['Real Apk']) ]),
      el('div',{class:'search'},[
        el('svg',{width:18,height:18,viewBox:'0 0 24 24',style:'opacity:.9'},[]),
        (function(){ const ip=el('input',{placeholder:'Search apps...',style:'background:transparent;border:0;outline:0;color:inherit'}); ip.addEventListener('input',()=>{ renderHomeList(ip.value); }); return ip; })()
      ])
    ]);
    root.appendChild(header);

    const featuredTitle = el('div',{},[ el('h2',{style:'margin:12px 0 2px;font-size:20px;font-weight:800'},['ðŸ”¥ Featured Apps']), el('div',{class:'muted'},['Premium selections']) ]);
    root.appendChild(featuredTitle);

    const featuredRow = el('div',{class:'featured-row'},[]);
    root.appendChild(featuredRow);

    const stats = el('div',{style:'display:flex;gap:12px;margin-top:12px'},[
      el('div',{class:'card',style:'min-width:0;flex:1;text-align:center'},[ el('div',{style:'font-weight:800;font-size:18px'},['5+']), el('div',{class:'muted'},['Total Apps']) ]),
      el('div',{class:'card',style:'min-width:0;flex:1;text-align:center'},[ el('div',{style:'font-weight:800;font-size:18px'},['3+']), el('div',{class:'muted'},['MOD Apps']) ]),
      el('div',{class:'card',style:'min-width:0;flex:1;text-align:center'},[ el('div',{style:'font-weight:800;font-size:18px'},['10+']), el('div',{class:'muted'},['Daily Updates']) ]),
    ]);
    root.appendChild(stats);

    const latestTitle = el('div',{style:'display:flex;justify-content:space-between;align-items:center;margin-top:18px'},[ el('div',{},[el('h3',{style:'font-size:18px;font-weight:800'},['Latest Posts']), el('div',{class:'muted'},['Newest uploads'])]) ]);
    root.appendChild(latestTitle);

    const latestGrid = el('div',{class:'grid'},[]);
    root.appendChild(latestGrid);

    // load apps
    const snap = await db.collection('apps').orderBy('createdAt','desc').get().catch(e=>{ console.error(e); });
    const docs = snap ? snap.docs.map(d=>({id:d.id,...d.data()})) : [];
    const featured = docs.filter(x=>x.isFeatured).slice(0,8);
    const latest = docs.slice(0,4);

    // populate featured
    featuredRow.innerHTML='';
    if(!featured.length) featuredRow.appendChild(el('div',{},['No featured apps yet']));
    featured.forEach(a=>{
      const c = el('div',{class:'card'},[
        el('div',{class:'small-card'},[ el('img',{class:'logo-img',src:a.logo||'',on:'', alt:''}), el('div',{},[ el('div',{style:'font-weight:800'},[a.name||'Untitled']), el('div',{class:'muted'},[a.description||'']) ]) ]),
        el('div',{},[
          el('div',{class:'muted',style:'margin-top:12px'},['v'+(a.version||'')]),
          el('div',{},[ el('button',{class:'primary', on:{ ev:'click', fn:()=> openPostNewTab(a.id) }},['VIEW']) ])
        ])
      ]);
      featuredRow.appendChild(c);
    });

    // populate latest
    latestGrid.innerHTML='';
    latest.forEach(a=>{
      const card = el('article',{class:'card'},[
        el('div',{class:'small-card'},[ el('img',{class:'logo-img',src:a.logo||'',alt:''}), el('div',{},[ el('div',{style:'font-weight:800'},[a.name||'Untitled']), el('div',{class:'muted'},[a.description||'']) ]) ]),
        el('div',{style:'display:flex;justify-content:space-between;align-items:center;margin-top:12px'},[ el('div',{class:'muted'},['v'+(a.version||'')]), el('div',{},[ el('button',{class:'primary', on:{ev:'click',fn:()=> openPostNewTab(a.id)}},['Details']) ]) ])
      ]);
      latestGrid.appendChild(card);
    });
  }

  async function renderHomeList(q=''){
    // If search used, just show filtered list (simplified)
    // For simplicity re-render whole home
    await renderHome();
    if(q){
      const nodes = Array.from(document.querySelectorAll('.card'));
      nodes.forEach(n=>{
        if(n.innerText.toLowerCase().includes(q.toLowerCase())) n.style.display='block'; else n.style.display='none';
      });
    }
  }

  async function renderPost(id){
    root.innerHTML='';
    // fetch doc
    const doc = await db.collection('apps').doc(id).get().catch(e=>null);
    if(!doc || !doc.exists){
      root.appendChild(el('div',{},['Post not found']));
      return;
    }
    const a = {id:doc.id,...doc.data()};
    const hero = el('div',{class:'detail-hero'},[
      el('img',{src:a.logo,style:'width:140px;height:140px;border-radius:12px;object-fit:cover;display:block;margin:0 auto',alt:''}),
      el('h1',{style:'text-align:center;margin-top:12px;font-size:20px;font-weight:800'},[a.name||'Untitled']),
      el('div',{style:'text-align:center',class:'muted'},[a.description||'']),
      el('div',{style:'display:flex;gap:8px;justify-content:center;margin-top:10px'},[
        el('div',{class:'pill'},['v'+(a.version||'')]),
        el('div',{class:'pill'},[a.type||'Original']),
        el('div',{class:'pill'},[(a.rating||'')+' â˜…'])
      ]),
      el('div',{style:'margin-top:14px;display:flex;gap:10px;justify-content:center'},[
        el('button',{class:'primary', on:{ev:'click',fn:()=> openDownloadLoader(a.id)}},['Download']),
        el('a',{href:a.playStoreLink||'#',target:'_blank',style:'padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);align-self:center'},['Play Store'])
      ])
    ]);
    root.appendChild(el('div',{},[hero]));

    // screenshots
    const scs = el('div',{style:'margin-top:16px'},[ el('div',{style:'font-weight:800'},['Screenshots']), el('div',{class:'screens'},[]) ]);
    root.appendChild(scs);
    const scRow = scs.querySelector('.screens');
    (a.screenshots || []).forEach(s=> scRow.appendChild(el('img',{src:s,alt:''})));
    if(!(a.screenshots||[]).length) scRow.appendChild(el('img',{src:a.logo,alt:''}));

    // description
    root.appendChild(el('div',{style:'margin-top:16px',class:'card'},[
      el('div',{style:'font-weight:800'},['Description']),
      el('div',{style:'margin-top:8px;color:#dbeafe'},[ a.fullDescription ? (function(){ const d = document.createElement('div'); d.innerHTML = a.fullDescription; return d; })() : (a.description || '') ])
    ]));
  }

  async function renderDownloadLoader(){
    root.innerHTML='';
    const h = location.hash||'';
    if(!h.startsWith('#dl:')){ renderHome(); return; }
    const id = h.slice(4);
    // fetch doc and redirect after 3s
    const doc = await db.collection('apps').doc(id).get().catch(e=>null);
    const a = doc && doc.exists ? {id:doc.id,...doc.data()} : null;
    const box = el('div',{class:'card',style:'text-align:center;max-width:520;margin:30px auto'},[
      el('div',{class:'loader-ring'},[]),
      el('div',{style:'font-weight:800;margin-top:10px;font-size:18px'},['Preparing your download...']),
      el('div',{class:'muted',style:'margin-top:6px'},[ a ? a.name : 'Please wait' ]),
      el('div',{style:'margin-top:12px',id:'countdown'},['Redirecting in 3s'])
    ]);
    root.appendChild(box);
    let t=3;
    const iv = setInterval(()=>{ t--; const cd = document.getElementById('countdown'); if(cd) cd.innerText = t>0 ? 'Redirecting in '+t+'s' : 'Redirecting...'; if(t<=0){ clearInterval(iv); if(a && a.apkLink) location.href = a.apkLink; else location.href = location.origin + location.pathname; } },1000);
  }

  /* Admin flow: only via #adminsecret */
  async function renderAdmin(){
    // show password prompt first
    const pw = prompt('Enter admin password (fetched from Firestore)'); if(pw===null) { history.back(); return; }
    // ensure admin doc exists
    const ref = db.collection('meta').doc('admin');
    const doc = await ref.get().catch(()=>null);
    if(!doc || !doc.exists){ await ref.set({ password: 'admin123' }); }
    const cur = (await ref.get()).data().password;
    if(pw !== cur){ alert('Incorrect password'); history.back(); return; }
    // now show admin UI
    root.innerHTML = '';
    const panel = el('div',{},[
      el('h2',{style:'font-size:18px;font-weight:800'},['Admin Dashboard']),
      el('div',{class:'admin-form'},[
        el('input',{placeholder:'App name',id:'af_name'}),
        el('input',{placeholder:'Logo URL',id:'af_logo'}),
        el('input',{placeholder:'Short description',id:'af_desc'}),
        el('textarea',{placeholder:'Full HTML description (optional)',id:'af_full',rows:4}),
        el('input',{placeholder:'Version',id:'af_ver'}),
        el('input',{placeholder:'Rating',id:'af_rating'}),
        el('input',{placeholder:'APK Link (direct)',id:'af_apk'}),
        el('input',{placeholder:'Play Store link',id:'af_play'}),
        el('input',{placeholder:'Screenshots (comma separated URLs)',id:'af_screens'}),
        el('div',{class:'admin-actions'},[
          el('button',{class:'primary', on:{ev:'click',fn:async ()=>{ const payload = {
            name:document.getElementById('af_name').value,
            logo:document.getElementById('af_logo').value,
            description:document.getElementById('af_desc').value,
            fullDescription:document.getElementById('af_full').value,
            version:document.getElementById('af_ver').value,
            rating:document.getElementById('af_rating').value,
            apkLink:document.getElementById('af_apk').value,
            playStoreLink:document.getElementById('af_play').value,
            screenshots:(document.getElementById('af_screens').value||'').split(',').map(s=>s.trim()).filter(Boolean),
            type:'MOD',
            isFeatured:false,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
          }; if(!payload.name) return alert('Name required'); await db.collection('apps').add(payload); alert('Added'); location.hash=''; renderHome(); } }},['Post New App']),
          el('button',{on:{ev:'click',fn:()=>{ location.hash=''; renderHome(); }}},['Exit Admin'])
        ])
      ])
    ]);
    root.appendChild(panel);

    // list existing
    const listWrap = el('div',{style:'margin-top:16px'},[]);
    root.appendChild(listWrap);
    const snap = await db.collection('apps').orderBy('createdAt','desc').get();
    const docs = snap.docs.map(d=>({id:d.id,...d.data()}));
    docs.forEach(it=>{
      const row = el('div',{class:'card',style:'display:flex;justify-content:space-between;align-items:center;margin-top:8px'},[
        el('div',{style:'display:flex;gap:12px;align-items:center'},[ el('img',{src:it.logo,style:'width:56px;height:56px;border-radius:8px',alt:''}), el('div',{},[ el('div',{style:'font-weight:800'},[it.name]), el('div',{class:'muted'},[it.description]) ]) ]),
        el('div',{},[
          el('button',{on:{ev:'click',fn:()=>{ document.getElementById('af_name').value=it.name; document.getElementById('af_logo').value=it.logo; document.getElementById('af_desc').value=it.description; document.getElementById('af_full').value=it.fullDescription||''; document.getElementById('af_ver').value=it.version||''; document.getElementById('af_rating').value=it.rating||''; document.getElementById('af_apk').value=it.apkLink||''; document.getElementById('af_play').value=it.playStoreLink||''; document.getElementById('af_screens').value=(it.screenshots||[]).join(',') } }},['Load']),
          el('button',{on:{ev:'click',fn:async ()=>{ if(!confirm('Delete?')) return; await db.collection('apps').doc(it.id).delete(); alert('Deleted'); renderAdmin(); }}},['Delete'])
        ])
      ]);
      listWrap.appendChild(row);
    });
  }

  /***** Router: check hash and render appropriate view *****/
  async function router(){
    const h = getHash();
    if(h.m === 'home') return renderHome();
    if(h.m === 'post') return renderPost(h.id);
    if(h.m === 'dl') return renderDownloadLoader();
    if(h.m === 'admin') return renderAdmin();
    return renderHome();
  }

  // initial render & listen for hash changes
  window.addEventListener('hashchange', router);
  router();

  </script>
</body>
</html>